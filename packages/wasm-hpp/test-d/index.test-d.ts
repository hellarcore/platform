// TS typings test
import { expectType } from 'tsd';

import loadDpp, { DPPModule, HellarPlatformProtocol, Identifier } from "..";

// Tests that loadDpp resolves DPPModule
expectType<Promise<DPPModule>>(loadDpp());

// Tests that dist exports wasm-hpp exported classes  (from WASM bindings)
const hppInstance = new HellarPlatformProtocol({}, 1);
expectType<HellarPlatformProtocol>(hppInstance);

// Tests that library exports Identifier class (from TS code in lib)
expectType<Identifier>(new Identifier(Buffer.alloc(32)));

// Tests that typings properly handle optional arguments (second argument of createFromBuffer)
// This test will fail if we pass JS code built by wasm-bindgen through TypeScript compilation
// instead of putting it directly to dist.
// If we do it this way, proper typings generated by wasm-bindgen will be ignored, and incorrect
// ones will be generated by TypeScript compiler.
hppInstance.stateTransition.createFromBuffer(Buffer.alloc(32), { });
